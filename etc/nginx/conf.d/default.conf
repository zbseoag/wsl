
server {

    server_name _;
	root /e/codemirror;
    listen 80 default_server;
    listen [::]:80 default_server;

	# SSL configuration
	#ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
	#ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;

	index index.php index.html ;
	location / {
		try_files $uri $uri/ =404;
	}

    location ~ /\.ht { deny all; }

	location ~ \.php$ {

		fastcgi_index   index.php;
        fastcgi_pass 	unix:/var/run/php/php-fpm.sock;
        #fastcgi_pass   localhost:9000;
        fastcgi_param   SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        include 		param/fastcgi.conf;
	}

}



###########################################
# tools.com
###########################################
server {

    server_name tools.com;
    root   /e/develop/php/tools;
    listen 80;

    location / {
        index  index.html index.php;
    }

    location ~ \.php$ {
        fastcgi_index   index.php;
        fastcgi_pass 	unix:/var/run/php/php-fpm.sock;
        fastcgi_param   SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        include 		param/fastcgi.conf;
    }

}


###########################################
# mysql.com
###########################################
server {

    server_name mysql.com;
    root   /e/phpMyAdmin;
    listen 80;

    location / {
        index  index.html index.php;
    }

    location ~ \.php$ {
        fastcgi_index   index.php;
        fastcgi_pass 	unix:/var/run/php/php-fpm.sock;
        fastcgi_param   SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        include 		param/fastcgi.conf;
    }

}


###########################################
# laravel.com
###########################################
server {

    server_name laravel.com;
    root /e/laravel/public;
    listen 80;
    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-XSS-Protection "1; mode=block";
    add_header X-Content-Type-Options "nosniff";


    index index.php;
    charset utf-8;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    error_page 404 /index.php;

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include 		param/fastcgi.conf;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }

}


###########################################
# phalcon.com 
###########################################
server {

    server_name   phalcon.com;
    root /e/tutorial/public;
    listen      80;

    ##########################
    # In production require SSL
    # listen 443 ssl default_server;

    # ssl on;
    # ssl_session_timeout  5m;
    # ssl_protocols  SSLv2 SSLv3 TLSv1;
    # ssl_ciphers  ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
    # ssl_prefer_server_ciphers   on;

    # These locations depend on where you store your certs
    # ssl_certificate        /var/nginx/certs/default.cert;
    # ssl_certificate_key    /var/nginx/certs/default.key;
    ##########################
   
    index index.php index.html;
    charset utf-8;
    client_max_body_size 100M;
    fastcgi_read_timeout 1800;

    location / {
        try_files $uri $uri/ /index.php?_url=$uri&$args;
    }

    location ~ [^/]\.php(/|$) {
        # try_files $uri =404;
        fastcgi_pass    unix:/var/run/php/php-fpm.sock;
        fastcgi_index /index.php;

        include param/fastcgi.conf;
        fastcgi_split_path_info ^(.+?\.php)(/.*)$;
        if (!-f $document_root$fastcgi_script_name) {
            return 404;
        }
        
        fastcgi_param PATH_INFO       $fastcgi_path_info;
        # fastcgi_param PATH_TRANSLATED $document_root$fastcgi_path_info;
        # and set php.ini cgi.fix_pathinfo=0
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        expires       max;
        log_not_found off;
        access_log    off;
    }
}

###########################################
# admin.com 
###########################################
server {
    listen       80;
    server_name  admin.com;
    root   /e/admin/public;
    location / {
        index  index.html index.php;
        if (!-e $request_filename) {
            rewrite  ^(.*)$  /index.php?s=/$1  last;
            break;
        }

    }

    location ~ \.php(.*)$ {

        fastcgi_pass    unix:/var/run/php/php-fpm.sock;
        fastcgi_index   index.php;
        fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        fastcgi_param  PATH_INFO  $fastcgi_path_info;
        fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
        include 		param/fastcgi.conf;
        
    }

}